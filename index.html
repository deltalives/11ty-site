<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Delta Lives</title><script defer="defer" src="/assets/js/alpine.js"></script><link rel="stylesheet" href="/tailwind.css"><link rel="stylesheet" href="/style.css"></head><body class="bg-green-100"><header class="bg-green-200 py-4"><nav><ul class="flex flex-row justify-center"><li class="text-4xl font-bold"><a href=""><p>ৰ-জীবন:</p></a></li></ul></nav></header><main class="bg-white p-4 m-4 rounded-lg shadow"><form enctype="multipart/form-data" method="post" class="flex flex-col gap-4 px-4 py-8 text-lg leading-4"><h1 class="text-xl">Media Upload / মিডিয়া জমা দিন</h1><fieldset><legend class="hidden">Name</legend><input type="text" name="name" id="name" placeholder="Name" required class="w-full px-2 py-4 border placeholder:text-gray"></fieldset><fieldset><legend class="hidden">Location</legend><input type="text" name="location" id="location" placeholder="Location /   অবস্থান" required class="w-full px-2 py-4 border placeholder:text-gray"></fieldset><fieldset><legend class="hidden">Age</legend><input type="number" name="age" id="age" placeholder="Age /  বয়স" class="w-full px-2 py-4 border placeholder:text-gray"></fieldset><fieldset><legend class="hidden">Text</legend><input type="text" name="text" id="text" placeholder="Text /   লিখুন " required class="w-full px-2 py-4 border placeholder:text-gray"></fieldset><fieldset><legend class="">Media / মিডিয়া</legend><input type="file" name="media" id="media" multiple="multiple"></fieldset><button type="submit" class="w-full p-4 text-white bg-green-300">Submit / জমা দিন</button></form></main><script>document.querySelector('form').addEventListener('submit', handleSubmit);
  document.querySelector('#media').addEventListener('change', onFileChange);
  let files = []
  function onFileChange(event) {
    files = event.target.files
  }

  function handleSubmit(event) {
    event.preventDefault();

    const request = new XMLHttpRequest();
    const formData = new FormData();
    const formElements = event.target.elements;
    const data = {};
    for (let i = 0; i < formElements.length; i++) {
      const currentElement = formElements[i];
      if (!['submit', 'file'].includes(currentElement.type)) {
        if(currentElement.value != "") {
          data[currentElement.name] = currentElement.value;
        }
      } else if (currentElement.type === 'file') {
        for (let i = 0; i < currentElement.files.length; i++) {
        
          const file = currentElement.files[i];
      console.log(file)
          formData.append(`files.${currentElement.name}`, file, file.name);
        }
      }
    }
    formData.append('data', JSON.stringify(data));
    request.open('POST', `https://delta-lives-strapi-backend.herokuapp.com/api/submissions`);
    request.send(formData)
    request.addEventListener('load', () => {
      window.location.reload()
    })
    
  }</script></body></html>