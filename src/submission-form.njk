---
layout: layout
title: "Delta Lives | Submission Portal"
permalink: submission/
---

{% set htmlTitle = title %}
<main>
  <form action="https://delta-lives-strapi-backend.herokuapp.com/api/submissions" enctype="multipart/form-data" method="post"
        class="flex flex-col gap-4 px-4 py-8
                font-text text-sm leading-4">

    <fieldset>
      <legend class="hidden">Name</legend>
      <input type="text" name="name" id="name" placeholder="Name" required
              class="w-full px-2 py-2 border placeholder:text-black">
    </fieldset>

    <fieldset>
      <legend class="hidden">Location</legend>
      <input type="text" name="location" id="location" placeholder="Location" required
              class="w-full px-2 py-2 border placeholder:text-black">
    </fieldset>

    <fieldset>
      <legend class="hidden">Age</legend>
      <input type="number" name="age" id="age" placeholder="Age"
              class="w-full px-2 py-2 border placeholder:text-black">
    </fieldset>

    <fieldset>
      <legend class="hidden">Text</legend>
      <input type="text" name="text" id="text" placeholder="Enter some text"
              class="w-full px-2 py-2 border placeholder:text-black">
      
    </fieldset> 

    <fieldset>
      <legend class="hidden">Media</legend>
      <input type="file" name="media" id="media" multiple>
      
    </fieldset> 
   
    <button type="submit"
            class="mt-auto p-2
                    self-center text-white font-display text-xs bg-black">
      Submit
    </button>

  </form>

</main>

<script>
  document.querySelector('form').addEventListener('submit', handleSubmit);
  document.querySelector('#media').addEventListener('change', onFileChange);
  let files = []
  function onFileChange(event) {
    files = event.target.files
  }

  function handleSubmit(event) {
    event.preventDefault();

    const request = new XMLHttpRequest();
    const formData = new FormData();
    const formElements = event.target.elements;
    const data = {};
    for (let i = 0; i < formElements.length; i++) {
      const currentElement = formElements[i];
      if (!['submit', 'file'].includes(currentElement.type)) {
        if(currentElement.value != "") {
          data[currentElement.name] = currentElement.value;
        }
      } else if (currentElement.type === 'file') {
        for (let i = 0; i < currentElement.files.length; i++) {
        
          const file = currentElement.files[i];
      console.log(file)
          formData.append(`files.${currentElement.name}`, file, file.name);
        }
      }
    }
    formData.append('data', JSON.stringify(data));
    request.open('POST', `https://delta-lives-strapi-backend.herokuapp.com/api/submissions`);
    request.send(formData)
    request.addEventListener('load', () => {
      window.location.reload()
    })
    
  }
</script>